---
tags:
  - EXPLOITATION
  - Linux
---
Podemos usar a ferramenta `getcap` para listar os recursos habilitados.

![[Pasted image 20231220203903.png]]

Quando executado como um usuário sem privilégios, o `getcap -r /` gerará uma grande quantidade de erros, portanto, é uma boa prática redirecionar as mensagens de erro para `/dev/null`.

Observe que nem o vim nem sua cópia têm o bit SUID definido. Portanto, esse vetor de escalonamento de privilégios não pode ser descoberto quando se enumeram os arquivos à procura de SUID.

![[Pasted image 20231220204401.png]]

O GTFObins tem uma boa lista de binários que podem ser aproveitados para o aumento de privilégios se encontrarmos algum recurso definido.

Observamos que o vim pode ser usado com o seguinte comando e carga útil:

![[Pasted image 20231220204415.png]]

```shell
./vim -c ':py3 import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'
```

Isso abrirá um shell raiz, conforme mostrado abaixo;

![[Pasted image 20231220204432.png]]
