---
tags:
  - EXPLOITATION
---
# Linux
#Primeiro, você pode executar o script abaixo. É importante que você leia a saída deste script.

- [LinEnum](https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh)

### Kernel e SO
```shell
uname -a 
cat /etc/issue 
cat /etc/redhat-release #//Redhat 
cat /etc/lsb-release #//Debian
```
### Misconfiguration sudo;
```shell
sudo -l 
sudo -u scriptmanager bash //Change user with "sudo" command #Detection of programs with SUID bits; 
find / -perm +4000 -user root -type f -print 2>/dev/null
```
### Scheduled jobs;
```shell
crontab -l
cat /etc/crontab
```
### Detecção de serviços rodando pelo root
```shell
ps aux | grep root
```
### Detecção de aplicações instaladas
```shell
ls -alh /usr/bin/ 
ls -alh /sbin/ 
dpkg -l
```
### Para mais enumerações manuais
https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/

# Windows
### Para detectar patches perdidos
https://github.com/AonCyberLabs/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.p
### SO
```powershell
systeminfo 
wmic qfe
```
### Users
```powershell
whoami 
echo %USERNAME% 
net users 
net user <username> 
whoami /priv 
net localgroup
```
### Rede
```powershell
ipconfig /all 
route print 
arp -A
netstat -ano
```
### Programas
```powershell
dir /a "C:\Program Files" 
dir /a "C:\Program Files (x86)" 
reg query HKEY_LOCAL_MACHINE\SOFTWARE
```
### Unquoted Service Patch
```powershell
wmic service get name displayname,pathname,startmode 2>nul |findstr /i "Auto" 2>nul |findstr /i /v "C:\Windows\\" 2>nul |findstr /i /v """
```
### Scheduled task
```powershell
schtasks /query /fo LIST 2>nul | findstr TaskName 
dir C:\windows\tasks
```

### Mais Links
https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/

https://www.youtube.com/watch?v=Fms9UuW05DA&list=PLi0kul0fEhZ9LNZN0-A3nX2xcx2R70JwN
### Groups.xml
```powershell
get Groups.xml 
cat Groups.xml (name, password) 
gpp-Decrypt password #decryp_password 
smbclient -W <domain_name> -U name //<domain_name>/share_name
```
### SPN
git https://github.com/SecureAuthCorp/impacket.git 
```powershell
python GetUsersSPN.py <domain_name>/user:decrypt_password -dc-ip <victim_ip> - request 
hashcat -m 13100 -a 0 hash.txt /usr/share/wordlists/rockyou.txt --force
```

